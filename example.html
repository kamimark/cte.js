<!DOCTYPE html>
<html>
<head>
  <script src="cte.debug.js"></script>
  <style>
    .hidden {
      display: none;
    }
    [cte] {
      display: none;
    }
  </style>
</head>
<body>
  <li cte="friend-item">
    <span data="name"></span>&nbsp;<span data="age"></span>
  </li>
  <!-- INVALID
  li cte="nicknames-item">
    <span data="$this"></span>
  </li-->
  <div cte="person-template">
      <select data="title">
      <option value="mr">Mr</option>
      <option value="mrs">Mrs</option>
      <option value="miss">Miss</option>
    </select>
    <span data="name"></span>
    <br/>
    <label>Age:</label><span data="age" data-type="number"></span>
    <br/>
      <br/>
    <input type="number" data="money" placeholder="money"></input>
    <br/>
    <input type="range" data="age" attrs="$global.age_range" placeholder="age"></input>
    <br/>
    <label>Has license:</label><input type="checkbox" data="has_license"></input>
    <br/>
    <ul data="friends" cte-ref="friend-item"></ul>
    <ul data="nicknames">
      <li><b><span data="$this"></span></b></li>
    </ul>
    <ul data="array2d">
      <li>
        <ul data="$this">
          <li><b><span data="$this"></span></b></li>
        </ul>
      </li>
    </ul>
  </div>

  <div cte="basic">
    <h1 data="title"></h1>
    <h2 data="subtitle"></h2>
    <input type="text" data="content.field1" placeholder="field1"></input>
    <input type="text" data="content.field2" placeholder="field2"></input>
    <div cte-ref="person-template" data="person"></div>
    <button id="getObj">Get</button>
    <button id="setObj">Set</button>
  </div>

  <button id="add">Add Single template</button>
  <button id="addMulti">Add Multiple templates</button>
  <button id="show" class="hidden">Show template</button>
  <button id="hide" class="hidden">Hide template</button>

  <div class="container"></div>
  <script>
    cte.$global.age_range = {min: 2, max: 10, step: 1};
    let object = {
      title: 'title',
      subtitle: 'subtitle',
      content: {'field1': 'Content1', 'field2': 'Content2'},
      person: {
        title: 'mr',
        name: 'Markos',
        age: 5,
        has_license: true,
        nicknames: ['Power Ranger', 'Captain Planet'],
        friends: [{name: 'John Doe', age:'Unknown'}, {name: 'Jean Doe', age:'25'}],
        array2d: [[1,2,3],[1,2,3],[1,2,3]]
      }
    };

    let object2 = {
      title: 'title2',
      subtitle: 'subtitle2',
      content: {'field1': 'Content12', 'field2': 'Content22'},
      person: {
        title: 'mr',
        name: 'Markos2',
        age: 5,
        has_license: true,
        nicknames: ['Power Ranger2', 'Captain Planet2'],
        friends: [{name: 'John Doe2', age:'Unknown2'}, {name: 'Jean Doe2', age:'25'}],
      }
    };

    const multiObjects = [object, object2];

    document
      .querySelector('#add')
      .addEventListener('click', (e) => {
        const template = cte.newDom('basic', '.container', object);
        template
          .querySelector('#getObj')
          .addEventListener('click', (e) => {
            const object = cte.getObject(template);
            console.log(object);
            alert(JSON.stringify(object));
        });

        template
          .querySelector('#setObj')
          .addEventListener('click', (e) => {
            object = cte.getObject(template);
        });
    });

    document
      .querySelector('#addMulti')
      .addEventListener('click', (e) => {
        const templates = cte.newDom('basic', '.container', multiObjects);
        for (const template of templates)
          for (const button of template.querySelectorAll('button'))
            button.parentNode.removeChild(button); 
    });
  </script>
</body>
</html>
